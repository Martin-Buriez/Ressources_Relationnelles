{% extends 'base.html.twig' %}

{% block title %}Le Blog {{ publication.title|capitalize }} {% endblock %}

{% block body %}
    <section class="bg-blue2 w-full">
        <div class="flex justify-center">
            <div class="w-5/6 border border-blue1 shadow-lg px-40 py-10 bg-white mb-8 mt-10">
                <!-- Thème et catégorie de la publication  -->
                <div class="flex">
                    <div class="w-1/2 flex justify-start text-2xl font-semibold text-blue1">
                        {{ publication.theme.name|capitalize }}
                    </div>
                    <div class="w-1/2 flex justify-end text-2xl font-semibold text-blue1">
                        {{ publication.category.title|capitalize }}
                    </div>
                </div>
                <div class="mx-auto h-px w-5/6 bg-blue1 mt-10"></div>
                <!-- Images de la publication -->
                <div class="flex justify-center w-full mt-10">
                    <div class="flex justify-center w-full">
                        <label class="w-full flex justify-center" for="publication">
                            {% for item in publication.publicationIncludeImages %}
                                <img class="w-7/12 border border-blue1" src="{{ asset('uploads/ressource/images/'~item.image.name) }}" alt="Ressource(s) cover"/>
                            {% endfor %}
                        </label>
                    </div>
                </div>
                <!-- Titre de la publication -->
                <div>
                    <div class="mt-8 text-center text-5xl font-extrabold text-blue1">
                        {{ publication.title|capitalize }}
                        <div class="mx-auto h-px w-1/3 bg-blue1 mt-8"></div>
                    </div>
                </div>
                <!-- Titre de la publication -->
                <div class="mb-20">
                    <div class="mt-8 text-center text-base font-medium">
                        {{ publication.description|capitalize }}
                    </div>
                </div>
                <!-- Container j'aime et vues -->
                <div class="w-3/12 px-10 mb-4">
                    <a href="#" class="px-4">
                        <i class="fas fa-eye">{{ publication.viewNumber }}</i>
                    </a>
                </div>
                <!--Auteur -->
                <div class="flex w-full items-center p-6 font-sans border border-blue1 rounded-2xl shadow-lg">
                    {% if publication.createdBy.ProfilePicture %}
                        <img
                            src="{{ asset('uploads/user/avatar/' ~ publication.createdBy.ProfilePicture) }}" alt="{{ publication.createdBy.username }}"
                            class="w-10 h-10 rounded-full overflow-hidden"
                        />
                    {% else %}
                        <img
                            src="{{ asset('assets/media/img/user.svg') }}" alt="Avatar de {{ publication.createdBy.username }}"
                            class="w-10 h-10 rounded-full overflow-hidden"
                        />
                    {% endif %}
                    <div class="px-3 flex-1">
                        <p class="text-base font-bold text-base md:text-xl leading-none">{{ publication.createdBy.username }}</p>
                        <p class="text-gray-600 text-xs md:text-base">Ce blog a été créé le {{ publication.createdAt|date('d-m-Y')}}
                    </div>
                    <div class="justify-end">
                        <a href="{{ path('profile_view', {'username': publication.createdBy.username }) }}" class="bg-transparent border border-main-blue dark:border-white text-xs text-main-blue hover:bg-main-blue hover:text-main-white font-bold py-2 px-4 rounded-full">Voir le profil</a>
                    </div>
                    {% if app.user %}
                        <div class="justify-end">
                            <a href="{{ path('user_can_ban_user', {'idUser': publication.createdBy.id }) }}" class="bg-transparent border border-main-blue dark:border-white text-xs text-main-blue hover:bg-main-blue hover:text-main-white font-bold py-2 px-4 rounded-full">
                                <i class="fas fa-flag"></i>
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- Commentaires -->
        {% for comment in comments %}
            {% if comment.comment.reportedStatus == false %}
                <div class="w-5/6 border border-blue1 shadow-lg px-40 py-10 bg-white mt-4 mx-auto">
                    <div class="flex">
                        <div class="w-1/2">
                            {{ comment.comment.title }}
                        </div>
                        <div class="flex justify-center">
                            <div class="mt-10 w-full">
                                {{ comment.comment.content }}
                            </div>
                        </div>
                        <div class="w-2/5 mx-5">
                            {{ comment.comment.createdAt|date('d-m-Y') }}
                        </div>
                        <div class="w-2/5 mx-5">
                            <a href="{{ path('user_can_ban_comment', {'idComment': comment.comment.id }) }}">
                                <i class="fas fa-ban"></i>
                            </a>
                        </div>
                    </div>
                </div>
            {% endif %}
        {% endfor %}
        {% if app.user %}
            <div class="w-5/6 border border-blue1 shadow-lg px-40 py-10 bg-white mt-4 mx-auto">
                {{ form_start(commentForm) }}
                <div class="flex">
                    <div class="w-1/2">
                        {{ form_row(commentForm.title) }}
                    </div>
                    <div class="flex justify-center">
                        <div class="mt-10 w-full">
                            {{ form_row(commentForm.content) }}
                        </div>
                    </div>
                    <div class="flex justify-center w-full mt-10">
                        <div class="w-2/5 mx-5">
                            {{ form_row(commentForm.submit) }}
                        </div>
                        <div class="w-2/5 mx-5">
                            <button class= 'w-full px-4 py-2 tracking-wide text-white transition-colors duration-200 transform bg-blue1 rounded-md hover:text-main-blue hover:bg-main-light-blue focus:outline-none focus:bg-blue-400 focus:ring focus:ring-blue-300 focus:ring-opacity-50'>Annuler</button>
                        </div>
                    </div>
                </div>
                {{ form_end(commentForm) }}
            </div>
        {% endif %}
        <!-- Fin commentaires -->
    </section>
{% endblock %}

