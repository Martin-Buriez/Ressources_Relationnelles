{% extends 'base.html.twig' %}

{% block title %}Mon espace !{% endblock %}

{% block body %}
    <section class="bg-white w-full">
        <div class="flex justify-end bg-blue2 w-full h-25 pt-48 shadow-lg">
            <div class="w-3/12">

            </div>
            <div class="w-9/12 flex pb-8">
                <div class="w-1/3">
                    <h1 class="text-5xl font-medium">{{ app.user.username }}</h1>
                </div>
            </div>
        </div>
        <div class="absolute left-14 top-64">
            {% if app.user.ProfilePicture %}
                <div class="rounded-full" style="height: 300px; width: 300px;">
                    <img src="{{ asset('uploads/user/avatar/' ~ app.user.ProfilePicture) }}" alt="{{ app.user.username }}" class="rounded-full shadow-lg" style="height: 300px; width: 300px;"/>
                </div>
            {% else %}
                <div class="rounded-full" style="height: 300px; width: 300px;">
                    <img src="{{ asset('assets/media/img/user.svg') }}" alt="Avatar de {{ app.user.username }}"  class="rounded-full shadow-lg" style="height: 300px; width: 300px;"/>
                </div>
            {% endif %}
        </div>
        <div class="flex justify-end pt-2 px-2">
            <div class="w-9/12">
                {% if app.user.description %}
                    <p class="text-xl text-gray-800">{{ app.user.description }} <a href="#" class="italic text-base">Modifier ma description</a></p>
                {% else %}
                    <p class="text-xl text-gray-800">Ceci est la description de votre nouveau profil utilisateur ! <a href="#" class="italic text-base">Modifier ma description</a></p>
                {% endif %}
            </div>
        </div>
        <div class="w-full mt-20 px-24">
            <div class="w-full flex justify-center">
                <div class="w-3/5 bg-blue1 h-px"></div>
            </div>
            <div class="flex justify-center mt-8">
                <div class="w-2/5 py-3 px-5 border border-blue1 shadow-lg">
                    {% if app.user.identityCardLocation is empty %}
                        {{ form_start(userCardForm) }}
                            <div>
                                <p class="text-center font-bold text-red-600">Vous n'avez pas encore vérifié votre identité !</p>
                                <div>
                                    <h1 class="underline text-center mt-2">Afin d'obtenir un statut validé :</h1>
                                    <p class="italic my-2 text-center">Vous pouvez déposer un justificatif permettant de vérifier votre nom prénom et adresse</br> Documents acceptés : Carte d'identité, Permis et Passeport.</p>
                                </div>
                                <div class="flex justify-center mt-5 mb-5">
                                    <div class="w-2/3 flex justify-center">
                                        {{ form_row(userCardForm.identityCardLocation) }}
                                    </div>
                                </div>
                                <div class="flex justify-center">
                                    <a class="w-2/6 btn py-1 bg-blue1 text-white rounded cursor-pointer object-cover border border-2 border-blue1">
                                        {{ form_row(userCardForm.submit) }}
                                    </a>
                                </div>
                            </div>
                        {{ form_end(userCardForm) }}
                    {% elseif app.user.identityCardLocation is not empty and app.user.identityCardValidated == true %}
                        <div>
                            <p class="text-center font-bold text-green-600">Votre compte est verifié</p>
                        </div>
                    {% else %}
                        <div>
                            <p class="text-center font-bold text-green-600">Votre justificatif est en cours de traitement</p>
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="w-full mt-14">
                <!-- Informations Utilisateur -->
                <div class="w-full border border-blue1 py-6 px-10 mx-2 shadow-lg">
                    <h2 class="text-blue1 font-bold text-xl">Vos informations utilisateur :</h2>
                    <div class="flex w-full">
                        <div class="w-1/2 mr-10">
                            <p class="font-semibold text-gray-700 mt-4 mb-1">Prénom :</p>
                            <p class="text-black border border-blue1 py-1 px-1">{{ app.user.FirstName|capitalize }}</p>
                        </div>
                        <div class="w-1/2">
                            <p class="font-semibold text-gray-700 mt-4 mb-1">Nom :</p>
                            <p class="text-black border border-blue1 py-1 px-1">{{ app.user.LastName|capitalize }}</p>
                        </div>
                    </div>

                    <div class="flex w-full">
                        <div class="w-1/2 mr-10">
                            <p class="font-semibold text-gray-700 mt-4 mb-1">Mail :</p>
                            <p class="text-black border border-blue1 py-1 px-1">{{ app.user.email }}</p>
                        </div>
                        <div class="w-1/2">
                            <p class="font-semibold text-gray-700 mt-4 mb-1">Téléphone :</p>
                            <p class="text-black border border-blue1 py-1 px-1">{{ app.user.phonenumber }}</p>
                        </div>
                    </div>

                    <div class="flex w-full">
                        <div class="w-1/2 mr-10">
                            <p class="font-semibold text-gray-700 mt-4 mb-1">Ville :</p>
                            <p class="text-black border border-blue1 py-1 px-1">{{ app.user.city }}</p>
                        </div>
                        <div class="w-1/2">
                            <p class="font-semibold text-gray-700 mt-4 mb-1">Code Postal :</p>
                            <p class="text-black border border-blue1 py-1 px-1">{{ app.user.postalcode }}</p>
                        </div>
                    </div>

                    <div class="flex w-full">
                        <div class="w-full">
                            <p class="font-semibold text-gray-700 mt-4 mb-1">Adresse :</p>
                            <p class="text-black border border-blue1 py-1 px-1">{{ app.user.address }}</p>
                        </div>
                    </div>

                    <div class="w-full flex justify-center mt-10">
                        <button class="w-1/3 btn py-1 bg-blue1 text-white rounded cursor-pointer object-cover border border-2 border-blue1">Modifier les informations</button>
                    </div>
                </div>

                <!-- Ressources Récentes & Accès au panel -->

                <div class="w-full border border-blue1 bg-blue1 py-2 px-10 mx-2 mt-8 shadow-lg">
                    <h2 class="text-white font-bold text-xl underline">Vos ressources récentes :</h2>
                </div>

                <div class="flex w-full mt-10 px-10">
                    {% for publication in userPublication|slice(0, 3) %}
                        <table class="w-full border border-blue1 shadow-lg">
                            <thead>
                            <tr class="font-bold text-white text-center border-b bg-blue1">
                                <th class="py-2">Titre</th>
                                <th class="py-2">Nombre de vues</th>
                                <th class="py-2">Date de création</th>
                            </tr>
                            </thead>
                            <tbody class="divide-gray-700 bg-gray-800 text-center">
                            <tr class="bg-blue2 text-black">
                                <td class="px-4 py-2">
                                    <a href="{{ path('publication_show', {'slug': publication.slug}) }}">{{ publication.title }}</a>
                                </td>
                                <td class="px-4 py-2 text-black">
                                    {{ publication.viewNumber }}
                                </td>
                                <td class="px-4 py-2 text-black">
                                    {{ publication.createdAt|date('d/m/Y') }}
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    {% endfor %}
                </div>

                <!-- Dernières ressources à ajouter -->

                <div class="w-full flex justify-items-center py-2 px-10 mx-2 mt-4">
                    <a href="{{ path('user_publication') }}" class="mx-auto w-1/6 cursor-pointer flex object-cover object-top items-center text-main-blue border border-2 border-blue1 font-bold transition-all duration-500 justify-center text-blue1 hover:border-white hover:text-white hover:bg-blue1 w-full  py-2 leading-6 bg-white rounded-lg"> Gérer mes ressources </a>
                    <a href="{{ path('add_publication') }}" class="mx-auto w-1/6 cursor-pointer flex object-cover object-top items-center text-main-blue border border-2 border-blue1 font-bold transition-all duration-500 justify-center text-blue1 hover:border-white hover:text-white hover:bg-blue1 w-full  py-2 leading-6 bg-white rounded-lg"> Ajouter une ressource </a>
                    <a href="{{ path('evenements') }}" class="mx-auto w-1/6 cursor-pointer flex object-cover object-top items-center text-main-blue border border-2 border-blue1 font-bold transition-all duration-500 justify-center text-blue1 hover:border-white hover:text-white hover:bg-blue1 w-full  py-2 leading-6 bg-white rounded-lg"> Gérer mes événements </a>
                    <a href="{{ path('create_event') }}" class="mx-auto w-1/6 cursor-pointer flex object-cover object-top items-center text-main-blue border border-2 border-blue1 font-bold transition-all duration-500 justify-center text-blue1 hover:border-white hover:text-white hover:bg-blue1 w-full  py-2 leading-6 bg-white rounded-lg"> Ajouter un événement </a>
                </div>

                <!-- Liste d'amis & Invitations-->
                <div class="w-full border border-blue1 py-6 px-10 mx-2 mt-8 shadow-lg mb-10">
                    <h2 class="text-blue1 font-bold text-xl">Votre liste d'amis :</h2>
                    <!-- Derniers amis ajoutés -->

                    <div class="flex">
                        <div class="flex w-full mt-5">
                            {% for friend in userFriend|slice(0, 3) %}
                                {% if friend.userReceive.username != app.user.username %}
                                    <div class="w-1/3">
                                        <div class="flex w-11/12 border border-blue1 shadow-lg px-2 py-2">

                                            <div class="w-5/12">
                                                {% if friend.userReceive.ProfilePicture %}
                                                    <div class="rounded-full" style="height: 150px; width: 150px;">
                                                        <img src="{{ asset('uploads/user/avatar/' ~ friend.userReceive.ProfilePicture) }}" alt="Avatar de {{ friend.userReceive.username }}" class="rounded-full shadow-lg" style="height: 150px; width: 150px;"/>
                                                    </div>
                                                {% else %}
                                                    <div class="rounded-full" style="height: 150px; width: 150px;">
                                                        <img src="{{ asset('assets/media/img/user.svg') }}" alt="Avatar de {{ friend.userReceive.username }}"  class="rounded-full shadow-lg" style="height: 150px; width: 150px;"/>
                                                    </div>
                                                {% endif %}
                                            </div>

                                            <div class="w-6/12 pt-2">
                                                <div class="flex justify-start text-blue1 text-xl font-bold ml-2">
                                                    <a target="_blank" rel="noreferrer noopener" href="{{ path('profile_view', {'username': friend.userReceive.username }) }}">
                                                        {{friend.userReceive.username}}
                                                    </a>
                                                </div>
                                                <div class="flex justify-start italic text-grey4 font-bold ml-1">
                                                    <p class="px-1">( {{friend.userReceive.firstname}}</p>
                                                    <p>{{friend.userReceive.lastname}} )</p>
                                                </div>
                                                <div class="flex justify-start mt-10 ml-1">
                                                    <a onclick="confirm('Supprimer cet utilisateur à vos amis ?')" class="ml-2" href="{{ path('user_delete_friend', {'idRelationShip': friend.id }) }}">
                                                        <i class="w-1/12 py-1 fas fa-user-minus pr-4 px-2"></i>
                                                        <span class="w-9/12 pl-2">Retirer de vos amis</span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                {% elseif friend.userSender.username != app.user.username %}
                                    <div class="w-1/3">
                                        <div class="flex w-11/12 border border-blue1 shadow-lg px-2 py-2">

                                            <div class="w-5/12">
                                                {% if friend.userSender.ProfilePicture %}
                                                    <div class="rounded-full" style="height: 150px; width: 150px;">
                                                        <img src="{{ asset('uploads/user/avatar/' ~ friend.userSender.ProfilePicture) }}" alt="{{ friend.userSender.username }}" class="rounded-full shadow-lg" style="height: 150px; width: 150px;"/>
                                                    </div>
                                                {% else %}
                                                    <div class="rounded-full" style="height: 150px; width: 150px;">
                                                        <img src="{{ asset('assets/media/img/user.svg') }}" alt="Avatar de {{friend.userSender.username }}"  class="rounded-full shadow-lg" style="height: 150px; width: 150px;"/>
                                                    </div>
                                                {% endif %}
                                            </div>

                                            <div class="w-6/12 pt-2">
                                                <div class="flex justify-start text-blue1 text-xl font-bold ml-2">
                                                    <a target="_blank" rel="noreferrer noopener" href="{{ path('profile_view', {'username': friend.userSender.username }) }}">
                                                        {{friend.userSender.username}}
                                                    </a>
                                                </div>
                                                <div class="flex justify-start italic text-grey4 font-bold ml-1">
                                                    <p class="px-1">( {{friend.userSender.firstname}}</p>
                                                    <p>{{friend.userSender.lastname}} )</p>
                                                </div>
                                                <div class="flex justify-start mt-10 ml-1">
                                                    <a onclick="confirm('Supprimer cet utilisateur à vos amis ?')" class="ml-2" href="{{ path('user_delete_friend', {'idRelationShip': friend.id }) }}">
                                                        <i class="w-1/12 py-1 fas fa-user-minus pr-4 px-2"></i>
                                                        <span class="w-9/12 pl-2">Retirer de vos amis</span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>

                    <div class="flex justify-end">
                        <a href="{{path('user_friend_list')}}" class="italic text-gray-800 text-base">Voir plus...</a>
                    </div>
                    <div class="w-1/6 flex justify-start">
                        <a href="{{path('user_invitations')}}" class="mx-auto w-full cursor-pointer flex object-cover object-top items-center text-main-blue border border-2 border-blue1 font-bold transition-all duration-500 justify-center text-blue1 hover:border-white hover:text-white hover:bg-blue1 py-1 leading-6 bg-white rounded-lg"> Vos demandes d'amis (1) </a>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}